var V=Object.defineProperty;var N=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var D=(s,e,t)=>e in s?V(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,T=(s,e)=>{for(var t in e||(e={}))K.call(e,t)&&D(s,t,e[t]);if(N)for(var t of N(e))Q.call(e,t)&&D(s,t,e[t]);return s};var v=(s,e,t)=>new Promise((n,i)=>{var c=u=>{try{f(t.next(u))}catch(l){i(l)}},y=u=>{try{f(t.throw(u))}catch(l){i(l)}},f=u=>u.done?n(u.value):Promise.resolve(u.value).then(c,y);f((t=t.apply(s,e)).next())});import{r as b,c as m,u as P,a as o,b as E,o as B,e as C,t as I,I as G,f as z,i as W,j as H,w as M,v as $,k as a,l as w,B as J,m as X,n as Y,F as Z,p as ee,q as se,s as r,A as j,x as A}from"./index.23965316.js";import{F as q}from"./index.a8ee9265.js";import"./index.c8ee7c1a.js";import"./_baseIteratee.b86b01a2.js";import"./isEqual.d65954b3.js";var te="/assets/login-box-bg.9027741f.svg",x=(s=>(s[s.LOGIN=0]="LOGIN",s[s.REGISTER=1]="REGISTER",s[s.RESET_PASSWORD=2]="RESET_PASSWORD",s[s.MOBILE=3]="MOBILE",s[s.QR_CODE=4]="QR_CODE",s))(x||{});const O=b(0);function U(){function s(n){O.value=n}const e=m(()=>O.value);function t(){s(0)}return{setLoginState:s,getLoginState:e,handleBackLogin:t}}function oe(s){function e(){return v(this,null,function*(){const t=o(s);return t?yield t.validate():void 0})}return{validForm:e}}function ne(s){const{t:e}=P(),t=m(()=>F(e("sys.login.accountPlaceholder"))),n=m(()=>F(e("sys.login.passwordPlaceholder"))),i=m(()=>F(e("sys.login.smsPlaceholder"))),c=m(()=>F(e("sys.login.mobilePlaceholder"))),y=(l,g)=>v(this,null,function*(){return g?Promise.resolve():Promise.reject(e("sys.login.policyPlaceholder"))}),f=l=>(g,p)=>v(this,null,function*(){return p?p!==l?Promise.reject(e("sys.login.diffPwd")):Promise.resolve():Promise.reject(e("sys.login.passwordPlaceholder"))});return{getFormRules:m(()=>{const l=o(t),g=o(n),p=o(i),_=o(c),h={sms:p,mobile:_};switch(o(O)){case 1:return T({account:l,password:g,confirmPassword:[{validator:f(s==null?void 0:s.password),trigger:"change"}],policy:[{validator:y,trigger:"change"}]},h);case 2:return T({account:l},h);case 3:return h;default:return{account:l,password:g}}})}}function F(s){return[{required:!0,message:s,trigger:"change"}]}const le={class:"mb-3 text-2xl font-bold text-center xl:text-3xl enter-x xl:text-left"},re=E({__name:"LoginFormTitle",setup(s){const{t:e}=P(),{getLoginState:t}=U(),n=m(()=>({[x.RESET_PASSWORD]:e("sys.login.forgetFormTitle"),[x.LOGIN]:e("sys.login.signInFormTitle"),[x.REGISTER]:e("sys.login.signUpFormTitle"),[x.MOBILE]:e("sys.login.mobileSignInFormTitle"),[x.QR_CODE]:e("sys.login.qrSignInFormTitle")})[o(t)]);return(i,c)=>(B(),C("h2",le,I(n.value),1))}}),ae=E({__name:"LoginForm",setup(s){const e=q.Item,t=G.Password,{t:n}=P(),{notification:i,createErrorModal:c}=ee(),{prefixCls:y}=z("login"),f=W(),{getLoginState:u}=U(),{getFormRules:l}=ne(),g=b(),p=b(!1),_=H({account:"admin",password:"123456"}),{validForm:h}=oe(g),k=m(()=>o(u)===x.LOGIN);function L(){return v(this,null,function*(){const R=yield h();if(!!R)try{p.value=!0;const d=yield f.login({password:R.password,username:R.account,mode:"none"});d&&i.success({message:n("sys.login.loginSuccessTitle"),description:`${n("sys.login.loginSuccessDesc")}: ${d.realName}`,duration:3})}catch(d){c({title:n("sys.api.errorTip"),content:d.message||n("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${y}`)||document.body})}finally{p.value=!1}})}return(R,d)=>(B(),C(Z,null,[M(a(re,{class:"enter-x"},null,512),[[$,k.value]]),M(a(o(q),{class:"p-4 enter-x",model:_,rules:o(l),ref_key:"formRef",ref:g,onKeypress:Y(L,["enter"])},{default:w(()=>[a(o(e),{name:"account",class:"enter-x"},{default:w(()=>[a(o(G),{size:"large",value:_.account,"onUpdate:value":d[0]||(d[0]=S=>_.account=S),placeholder:o(n)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),a(o(e),{name:"password",class:"enter-x"},{default:w(()=>[a(o(t),{size:"large",visibilityToggle:"",value:_.password,"onUpdate:value":d[1]||(d[1]=S=>_.password=S),placeholder:o(n)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),a(o(e),{class:"enter-x"},{default:w(()=>[a(o(J),{type:"primary",size:"large",block:"",onClick:L,loading:p.value},{default:w(()=>[X(I(o(n)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[$,k.value]])],64))}});const ie={class:"-enter-x xl:hidden"},ce={class:"container relative h-full py-2 mx-auto sm:px-10"},ue={class:"flex h-full"},de={class:"hidden min-h-full pl-4 mr-4 xl:flex xl:flex-col xl:w-6/12"},me={class:"my-auto"},ge=["alt"],pe={class:"mt-10 font-medium text-white -enter-x"},fe={class:"inline-block mt-4 text-3xl"},_e={class:"mt-5 font-normal text-white text-md dark:text-gray-500 -enter-x"},xe={class:"flex w-full h-full py-5 xl:h-auto xl:py-0 xl:my-0 xl:w-6/12"},Ie=E({__name:"Login",props:{sessionTimeout:{type:Boolean}},setup(s){const e=se(),{prefixCls:t}=z("login"),{t:n}=P(),i=m(()=>{var c;return(c=e==null?void 0:e.title)!=null?c:""});return(c,y)=>(B(),C("div",{class:A([o(t),"relative w-full h-full px-4"])},[r("span",ie,[a(o(j),{alwaysShowTitle:!0})]),r("div",ce,[r("div",ue,[r("div",de,[a(o(j),{class:"-enter-x"}),r("div",me,[r("img",{alt:i.value,src:te,class:"w-1/2 -mt-16 -enter-x"},null,8,ge),r("div",pe,[r("span",fe,I(o(n)("sys.login.signInTitle")),1)]),r("div",_e,I(o(n)("sys.login.signInDesc")),1)])]),r("div",xe,[r("div",{class:A([`${o(t)}-form`,"relative w-full px-5 py-8 mx-auto my-auto rounded-md shadow-md xl:ml-16 xl:bg-transparent sm:px-8 xl:p-4 xl:shadow-none sm:w-3/4 lg:w-2/4 xl:w-auto enter-x"])},[a(ae)],2)])])])],2))}});export{Ie as default};
