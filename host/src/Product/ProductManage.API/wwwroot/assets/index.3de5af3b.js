var B=(e,t,u)=>new Promise((m,s)=>{var c=n=>{try{a(u.next(n))}catch(b){s(b)}},o=n=>{try{a(u.throw(n))}catch(b){s(b)}},a=n=>n.done?m(n.value):Promise.resolve(n.value).then(c,o);a((u=u.apply(e,t)).next())});import{B as y,l as M}from"./useForm.37d1448d.js";import{B as N,u as $}from"./useTable.69b94410.js";import{a as O}from"./index.91fe59c6.js";import{ci as i,ei as l,b as R,a_ as S,a$ as p,o as T,b0 as w,l as F,k as d,b3 as x,d2 as V,j as v,c as z,m as P,p as W}from"./index.23965316.js";import{C as A,S as k}from"./index.b43c7946.js";import"./index.b163296c.js";import"./index.c8ee7c1a.js";import{p as D}from"./pc.9bd1b3cb.js";import{B as G,a as j,b as K}from"./index.48aaa24a.js";import{e as U}from"./productApi.e312dfc9.js";import"./index.a8ee9265.js";import"./_baseIteratee.b86b01a2.js";import"./isEqual.d65954b3.js";import"./index.e35512a5.js";import"./index.08362023.js";import"./index.9863576d.js";import"./useContentViewHeight.553e56bf.js";import"./index.72f58c9d.js";import"./RedoOutlined.1e197eb0.js";import"./useSortable.edefc71c.js";import"./index.ea762078.js";import"./scrollTo.683c5f3d.js";import"./index.83f13437.js";import"./index.b5cd44d2.js";import"./ArrowLeftOutlined.686d2e0c.js";const H=D.map(e=>({id:e.code,label:e.name,value:e.name,key:e.code})),J=[{label:i.ShaftingSystem.name,value:i.ShaftingSystem.id},{label:i.RudderSystem.name,value:i.RudderSystem.id},{label:i.NonStandardPart.name,value:i.NonStandardPart.id},{label:i.StandardPart.name,value:i.StandardPart.id},{label:i.Other.name,value:i.Other.id}];l.Blanking.name,l.Blanking.id,l.RoughTurning.name,l.RoughTurning.id,l.FineTurning.name,l.FineTurning.id,l.Perforate.name,l.Perforate.id,l.FineMilling.name,l.FineMilling.id,l.Compounding.name,l.Compounding.id;const L=[{field:"description",component:"Input",label:"\u63CF\u8FF0",required:!0,colProps:{span:4}},{field:"divider-info-linked",component:"Divider",label:"\u7532\u65B9\u4FE1\u606F",colProps:{span:24}},{field:"title",component:"Input",label:"\u516C\u53F8\u540D\u79F0",required:!0,colProps:{span:4}},{field:"tax",component:"Input",label:"\u7A0E\u53F7",required:!0,colProps:{span:4,offset:2}},{field:"bankInfo",component:"Input",label:"\u5F00\u6237\u94F6\u884C",required:!0,colProps:{span:4,offset:2}},{field:"bankAccount",component:"Input",label:"\u94F6\u884C\u8D26\u53F7",required:!0,colProps:{span:4,offset:2}},{field:"phoneNumber",component:"Input",label:"\u8054\u7CFB\u7535\u8BDD",required:!0,colProps:{span:4}},{field:"divider-address-linked",component:"Divider",label:"\u7532\u65B9\u5730\u5740",colProps:{span:24}},{field:"province",component:"Select",label:"\u7701\u4EFD",required:!0,colProps:{span:4},componentProps:({formModel:e,formActionType:t})=>({options:H,placeholder:"\u8BF7\u9009\u62E9\u7701\u4EFD",onChange:u=>{var c;console.log(u);const m=(c=D.find(o=>o.name==u))==null?void 0:c.children.map(o=>({id:o.code,label:o.name,value:o.name,key:o.code}));e.city=void 0;const{updateSchema:s}=t;s({field:"city",componentProps:{options:m}})}})},{field:"city",component:"Select",label:"\u57CE\u5E02",required:!0,colProps:{span:4,offset:2},componentProps:{options:[],placeholder:"\u8BF7\u9009\u62E9\u57CE\u5E02"}},{field:"street",component:"Input",label:"\u8857\u9053",required:!0,colProps:{span:4,offset:2}},{field:"zipCode",component:"Input",label:"\u90AE\u653F\u7F16\u7801",required:!0,colProps:{span:4,offset:2}}],Q=[{title:"\u540D\u79F0",dataIndex:"productItemName",width:100},{title:"\u4EA7\u54C1\u7C7B\u578B",dataIndex:"productTypeId",width:100,customRender:({text:e})=>{const t=i.from(e);return t==null?void 0:t.name}},{title:"\u6280\u672F\u8981\u6C42",dataIndex:"technicalRequirements",width:100},{title:"\u6750\u6599",dataIndex:"material",width:100},{title:"\u89C4\u683C",dataIndex:"diameter",width:100},{title:"\u957F\u5EA6",dataIndex:"length",width:100},{title:"\u56FE\u53F7",dataIndex:"figureNo",width:100},{title:"\u603B\u8BA1",dataIndex:"amount",width:100},{title:"\u5355\u4F4D",dataIndex:"unit",width:100}],q=[{field:"productItemName",component:"Input",label:"\u540D\u5B57",required:!0},{field:"productTypeId",component:"Select",label:"\u4EA7\u54C1\u7C7B\u578B",required:!0,componentProps:{options:J}},{field:"technicalRequirements",component:"Input",label:"\u6280\u672F\u8981\u6C42",required:!0},{field:"material",component:"Input",label:"\u6750\u6599",required:!0},{field:"diameter",component:"Input",label:"\u89C4\u683C",required:!0},{field:"length",component:"Input",label:"\u957F\u5EA6",required:!0},{field:"figureNo",component:"Input",label:"\u56FE\u53F7",required:!0},{field:"amount",component:"Input",label:"\u603B\u8BA1",required:!0},{field:"unit",component:"Input",label:"\u5355\u4F4D",required:!0}],X=R({components:{BasicModal:G,BasicForm:y},emits:["ok"],setup(e,{emit:t}){const[u,{validate:m,resetFields:s}]=M({labelWidth:120,schemas:q,showActionButtonGroup:!1,actionColOptions:{span:24}}),[c,{closeModal:o}]=j(n=>{console.log(n)});return{register:c,productItemFormSchemas:q,registerForm:u,addProductItem:()=>B(this,null,function*(){const n=yield m();t("ok",n),o(),s()}),closeModal:o}}});function Y(e,t,u,m,s,c){const o=p("BasicForm"),a=p("BasicModal");return T(),w(a,x(e.$attrs,{onRegister:e.register,title:"\u521B\u5EFA\u4EA7\u54C1\u660E\u7EC6\u9879",onOk:e.addProductItem,onCancel:e.closeModal}),{default:F(()=>[d(o,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","onOk","onCancel"])}var Z=S(X,[["render",Y]]);const ee=R({name:"CreateProductPage",components:{BasicForm:y,PageWrapper:O,BasicTable:N,CreateProductItemModal:Z,PopConfirmButton:V,[A.name]:A,[k.name]:k},setup(){const e=v({}),t=v([]),u=z(()=>t),[m,{resetFields:s,validate:c}]=M({layout:"vertical",baseColProps:{span:6},schemas:L,showActionButtonGroup:!1}),[o,{reload:a}]=$({columns:Q,dataSource:u,showIndexColumn:!1,canResize:!0,rowKey:"name",scroll:{y:200},pagination:!1}),[n,{openModal:b}]=K(),{createMessage:I}=W(),C=()=>{b(!0)},h=()=>B(this,null,function*(){const r=yield c(),E={city:r.city,street:r.street,province:r.province,zipCode:r.zipCode,description:r.description,title:r.title,tax:r.tax,bankInfo:r.bankInfo,bankAccount:r.bankAccount,phoneNumber:r.phoneNumber,productItems:t.map(f=>({productTypeId:f.productTypeId,amount:f.amount,productItemName:f.productItemName,technicalRequirements:f.technicalRequirements,material:f.material,diameter:f.diameter,length:f.length,figureNo:f.figureNo,unit:f.unit}))};console.log(E),yield U(E),I.success("\u521B\u5EFA\u6210\u529F"),g()}),g=()=>{s(),t.length=0,a()};return{register:m,registerTable:o,registerModal:n,addProductItem:C,createProduct:h,resetInput:g,addItem:r=>{t.push(r),a()},productItemModel:e}}});function te(e,t,u,m,s,c){const o=p("BasicForm"),a=p("a-card"),n=p("BasicTable"),b=p("a-button"),I=p("PopConfirmButton"),C=p("a-space"),h=p("CreateProductItemModal"),g=p("PageWrapper");return T(),w(g,{class:"high-form",title:"\u4EA7\u54C1\u521B\u5EFA",content:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u4FE1\u606F\u540E\u6DFB\u52A0\u4EA7\u54C1\u9879"},{default:F(()=>[d(a,{title:"\u4EA7\u54C1\u4FE1\u606F",bordered:!1},{default:F(()=>[d(o,{onRegister:e.register},null,8,["onRegister"])]),_:1}),d(a,{title:"\u4EA7\u54C1\u9879",bordered:!1},{default:F(()=>[d(n,{onRegister:e.registerTable},null,8,["onRegister"]),d(b,{block:"",class:"mt-5",onClick:e.addProductItem},{default:F(()=>[P(" \u65B0\u589E\u4EA7\u54C1\u9879 ")]),_:1},8,["onClick"])]),_:1}),d(a,{bordered:!1,align:"center",class:"!mt-5"},{default:F(()=>[d(C,null,{default:F(()=>[d(I,{type:"info",title:"\u786E\u8BA4\u91CD\u7F6E\uFF1F",onConfirm:e.resetInput},{default:F(()=>[P("\u91CD\u7F6E")]),_:1},8,["onConfirm"]),d(I,{type:"primary",class:"!ml-5",title:"\u786E\u8BA4\u63D0\u4EA4\uFF1F",onConfirm:e.createProduct},{default:F(()=>[P("\u63D0\u4EA4")]),_:1},8,["onConfirm"])]),_:1})]),_:1}),d(h,{onRegister:e.registerModal,modelValue:e.productItemModel,"onUpdate:modelValue":t[0]||(t[0]=_=>e.productItemModel=_),onOk:e.addItem},null,8,["onRegister","modelValue","onOk"])]),_:1})}var qe=S(ee,[["render",te],["__scopeId","data-v-79f25c1d"]]);export{qe as default};
