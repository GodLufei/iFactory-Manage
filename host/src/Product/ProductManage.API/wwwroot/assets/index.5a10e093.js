var C=(e,o,r)=>new Promise((s,l)=>{var n=a=>{try{m(r.next(a))}catch(d){l(d)}},c=a=>{try{m(r.throw(a))}catch(d){l(d)}},m=a=>a.done?s(a.value):Promise.resolve(a.value).then(n,c);m((r=r.apply(e,o)).next())});import{bk as v,r as h,a as t,dj as A,u as L,em as b,k as i,b as x,o as y,b0 as M,l as u,b3 as S,en as B,T as P,aa as V,a3 as j,a$ as $,e as w,F,b5 as N,w as O,v as U,m as D,t as E}from"./index.23965316.js";import{B as H,b as J}from"./index.48aaa24a.js";import{D as X}from"./index.6596aa75.js";import{T as q}from"./index.08362023.js";import{u as z,B as G}from"./useTable.69b94410.js";import{T as K}from"./useForm.37d1448d.js";import{d as Q}from"./index.91fe59c6.js";import"./useContentViewHeight.553e56bf.js";import"./_baseIteratee.b86b01a2.js";import"./isEqual.d65954b3.js";import"./index.c8ee7c1a.js";import"./index.9863576d.js";import"./index.72f58c9d.js";import"./index.e35512a5.js";import"./useSortable.edefc71c.js";import"./RedoOutlined.1e197eb0.js";import"./index.ea762078.js";import"./index.a8ee9265.js";import"./scrollTo.683c5f3d.js";import"./index.83f13437.js";import"./index.b5cd44d2.js";import"./ArrowLeftOutlined.686d2e0c.js";function W(e){if(!v())throw new Error("useDescription() can only be used inside setup() or functional components!");const o=h(null),r=h(!1);function s(n){t(r)&&A()||(o.value=n,e&&n.setDescProps(e),r.value=!0)}return[s,{setDescProps:n=>{var c;(c=t(o))==null||c.setDescProps(n)}}]}const{t:p}=L();function I(){return[{dataIndex:"type",title:p("sys.errorLog.tableColumnType"),width:80,customRender:({text:e})=>{const o=e===b.VUE?"green":e===b.RESOURCE?"cyan":e===b.PROMISE?"blue":b.AJAX?"red":"purple";return i(q,{color:o},{default:()=>e})}},{dataIndex:"url",title:"URL",width:200},{dataIndex:"time",title:p("sys.errorLog.tableColumnDate"),width:160},{dataIndex:"file",title:p("sys.errorLog.tableColumnFile"),width:200},{dataIndex:"name",title:"Name",width:200},{dataIndex:"message",title:p("sys.errorLog.tableColumnMsg"),width:300},{dataIndex:"stack",title:p("sys.errorLog.tableColumnStackMsg")}]}function Y(){return I().map(e=>({field:e.dataIndex,label:e.title}))}const Z=x({__name:"DetailModal",props:{info:{type:Object,default:null}},setup(e){const{t:o}=L(),[r]=W({column:2,schema:Y()});return(s,l)=>(y(),M(t(H),S({width:800,title:t(o)("sys.errorLog.tableActionDesc")},s.$attrs),{default:u(()=>[i(t(X),{data:e.info,onRegister:t(r)},null,8,["data","onRegister"])]),_:1},16,["title"]))}}),ee=()=>Q.get({url:"/error"}),te={class:"p-4"},re=["src"],Re=x({__name:"index",setup(e){const o=h(),r=h([]),{t:s}=L(),l=B(),[n,{setTableData:c}]=z({title:s("sys.errorLog.tableTitle"),columns:I(),actionColumn:{width:80,title:"Action",dataIndex:"action",slots:{customRender:"action"}}}),[m,{openModal:a}]=J();P(()=>l.getErrorLogInfoList,f=>{V(()=>{c(j(f))})},{immediate:!0});function d(f){o.value=f,a(!0)}function R(){throw new Error("fire vue error!")}function T(){r.value.push(`${new Date().getTime()}.png`)}function k(){return C(this,null,function*(){yield ee()})}return(f,oe)=>{const _=$("a-button");return y(),w("div",te,[(y(!0),w(F,null,N(r.value,g=>O((y(),w("img",{key:g,src:g},null,8,re)),[[U,!1]])),128)),i(Z,{info:o.value,onRegister:t(m)},null,8,["info","onRegister"]),i(t(G),{onRegister:t(n),class:"error-handle-table"},{toolbar:u(()=>[i(_,{onClick:R,type:"primary"},{default:u(()=>[D(E(t(s)("sys.errorLog.fireVueError")),1)]),_:1}),i(_,{onClick:T,type:"primary"},{default:u(()=>[D(E(t(s)("sys.errorLog.fireResourceError")),1)]),_:1}),i(_,{onClick:k,type:"primary"},{default:u(()=>[D(E(t(s)("sys.errorLog.fireAjaxError")),1)]),_:1})]),action:u(({record:g})=>[i(t(K),{actions:[{label:t(s)("sys.errorLog.tableActionDesc"),onClick:d.bind(null,g)}]},null,8,["actions"])]),_:1},8,["onRegister"])])}}});export{Re as default};
