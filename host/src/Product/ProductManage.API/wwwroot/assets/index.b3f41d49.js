var C=(e,o,r)=>new Promise((s,l)=>{var n=a=>{try{m(r.next(a))}catch(d){l(d)}},c=a=>{try{m(r.throw(a))}catch(d){l(d)}},m=a=>a.done?s(a.value):Promise.resolve(a.value).then(n,c);m((r=r.apply(e,o)).next())});import{bk as v,r as h,a as t,dj as A,u as L,em as b,k as i,b as x,o as y,b0 as M,l as u,b3 as S,en as B,T as P,aa as V,a3 as j,a$ as $,e as w,F,b5 as N,w as O,v as U,m as D,t as E}from"./index.f5037e0e.js";import{B as H,b as J}from"./index.20502e53.js";import{D as X}from"./index.e5fe358c.js";import{T as q}from"./index.a3b14931.js";import{u as z,B as G}from"./useTable.ceee4688.js";import{T as K}from"./useForm.ede354a2.js";import{d as Q}from"./index.088c10bd.js";import"./useContentViewHeight.bf04c9e4.js";import"./_baseIteratee.95b83d5c.js";import"./isEqual.6f9a623a.js";import"./index.8089f2c1.js";import"./index.7bad8a45.js";import"./index.f2477e00.js";import"./index.75b6fcd6.js";import"./useSortable.bb4baa66.js";import"./RedoOutlined.16dcdfe4.js";import"./index.6e45ebf0.js";import"./index.be215484.js";import"./scrollTo.779d4262.js";import"./index.dcc1b961.js";import"./index.bb86497d.js";import"./ArrowLeftOutlined.c09ac8d8.js";function W(e){if(!v())throw new Error("useDescription() can only be used inside setup() or functional components!");const o=h(null),r=h(!1);function s(n){t(r)&&A()||(o.value=n,e&&n.setDescProps(e),r.value=!0)}return[s,{setDescProps:n=>{var c;(c=t(o))==null||c.setDescProps(n)}}]}const{t:p}=L();function I(){return[{dataIndex:"type",title:p("sys.errorLog.tableColumnType"),width:80,customRender:({text:e})=>{const o=e===b.VUE?"green":e===b.RESOURCE?"cyan":e===b.PROMISE?"blue":b.AJAX?"red":"purple";return i(q,{color:o},{default:()=>e})}},{dataIndex:"url",title:"URL",width:200},{dataIndex:"time",title:p("sys.errorLog.tableColumnDate"),width:160},{dataIndex:"file",title:p("sys.errorLog.tableColumnFile"),width:200},{dataIndex:"name",title:"Name",width:200},{dataIndex:"message",title:p("sys.errorLog.tableColumnMsg"),width:300},{dataIndex:"stack",title:p("sys.errorLog.tableColumnStackMsg")}]}function Y(){return I().map(e=>({field:e.dataIndex,label:e.title}))}const Z=x({__name:"DetailModal",props:{info:{type:Object,default:null}},setup(e){const{t:o}=L(),[r]=W({column:2,schema:Y()});return(s,l)=>(y(),M(t(H),S({width:800,title:t(o)("sys.errorLog.tableActionDesc")},s.$attrs),{default:u(()=>[i(t(X),{data:e.info,onRegister:t(r)},null,8,["data","onRegister"])]),_:1},16,["title"]))}}),ee=()=>Q.get({url:"/error"}),te={class:"p-4"},re=["src"],Re=x({__name:"index",setup(e){const o=h(),r=h([]),{t:s}=L(),l=B(),[n,{setTableData:c}]=z({title:s("sys.errorLog.tableTitle"),columns:I(),actionColumn:{width:80,title:"Action",dataIndex:"action",slots:{customRender:"action"}}}),[m,{openModal:a}]=J();P(()=>l.getErrorLogInfoList,f=>{V(()=>{c(j(f))})},{immediate:!0});function d(f){o.value=f,a(!0)}function R(){throw new Error("fire vue error!")}function T(){r.value.push(`${new Date().getTime()}.png`)}function k(){return C(this,null,function*(){yield ee()})}return(f,oe)=>{const _=$("a-button");return y(),w("div",te,[(y(!0),w(F,null,N(r.value,g=>O((y(),w("img",{key:g,src:g},null,8,re)),[[U,!1]])),128)),i(Z,{info:o.value,onRegister:t(m)},null,8,["info","onRegister"]),i(t(G),{onRegister:t(n),class:"error-handle-table"},{toolbar:u(()=>[i(_,{onClick:R,type:"primary"},{default:u(()=>[D(E(t(s)("sys.errorLog.fireVueError")),1)]),_:1}),i(_,{onClick:T,type:"primary"},{default:u(()=>[D(E(t(s)("sys.errorLog.fireResourceError")),1)]),_:1}),i(_,{onClick:k,type:"primary"},{default:u(()=>[D(E(t(s)("sys.errorLog.fireAjaxError")),1)]),_:1})]),action:u(({record:g})=>[i(t(K),{actions:[{label:t(s)("sys.errorLog.tableActionDesc"),onClick:d.bind(null,g)}]},null,8,["actions"])]),_:1},8,["onRegister"])])}}});export{Re as default};
